
Epoch 0 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
Traceback (most recent call last):
  File "supcl_ft.py", line 652, in <module>
    logits = model(batch["data"].T)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/TU/watchog/watchog/model.py", line 538, in forward
    pooled_output = self.pooler(bert_output[0], pooler_output=bert_output[1], cls_indexes=cls_indexes, table_length=table_length).squeeze(0)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/TU/watchog/watchog/model.py", line 460, in forward
    pooled_outputs = extract_cls_tokens(hidden_states, cls_indexes)
  File "/home/zhihao/jupyterprojects/TU/watchog/watchog/model.py", line 437, in extract_cls_tokens
    for i, j in cls_indexes:
TypeError: 'NoneType' object is not iterable