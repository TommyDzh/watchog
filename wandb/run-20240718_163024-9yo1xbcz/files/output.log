/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
supcl_ft.py:642: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matricesor `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2981.)
  labels = batch["label"].T
Epoch 0 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 0 (gt-semtab22-dbpedia-all0): tr_loss=3.3743086 tr_macro_f1=0.0194 tr_micro_f1=0.2812  vl_loss=2.9898769 vl_macro_f1=0.0294 vl_micro_f1=0.3481 (52.13 sec.)
Epoch 1 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 1 (gt-semtab22-dbpedia-all0): tr_loss=2.6928784 tr_macro_f1=0.0585 tr_micro_f1=0.4057  vl_loss=2.5141090 vl_macro_f1=0.0616 vl_micro_f1=0.4217 (51.56 sec.)
Epoch 2 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 2 (gt-semtab22-dbpedia-all0): tr_loss=2.1850812 tr_macro_f1=0.1089 tr_micro_f1=0.5101  vl_loss=2.3027002 vl_macro_f1=0.0964 vl_micro_f1=0.4637 (53.25 sec.)
Epoch 3 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 3 (gt-semtab22-dbpedia-all0): tr_loss=1.7365668 tr_macro_f1=0.1678 tr_micro_f1=0.5943  vl_loss=2.1089702 vl_macro_f1=0.1446 vl_micro_f1=0.4921 (52.17 sec.)
Epoch 4 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 4 (gt-semtab22-dbpedia-all0): tr_loss=1.3462781 tr_macro_f1=0.2706 tr_micro_f1=0.6845  vl_loss=2.1902022 vl_macro_f1=0.1874 vl_micro_f1=0.5110 (52.02 sec.)
Epoch 5 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 5 (gt-semtab22-dbpedia-all0): tr_loss=1.0566437 tr_macro_f1=0.3660 tr_micro_f1=0.7538  vl_loss=2.1447160 vl_macro_f1=0.2368 vl_micro_f1=0.5121 (52.26 sec.)
Epoch 6 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 6 (gt-semtab22-dbpedia-all0): tr_loss=0.8133627 tr_macro_f1=0.4965 tr_micro_f1=0.8215  vl_loss=2.2081964 vl_macro_f1=0.2384 vl_micro_f1=0.5184 (53.37 sec.)
Epoch 7 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 7 (gt-semtab22-dbpedia-all0): tr_loss=0.6052448 tr_macro_f1=0.5797 tr_micro_f1=0.8693  vl_loss=2.2330870 vl_macro_f1=0.2518 vl_micro_f1=0.5163 (53.79 sec.)
Epoch 8 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 8 (gt-semtab22-dbpedia-all0): tr_loss=0.4493824 tr_macro_f1=0.7117 tr_micro_f1=0.9125  vl_loss=2.3136394 vl_macro_f1=0.2556 vl_micro_f1=0.5184 (52.63 sec.)
Epoch 9 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 9 (gt-semtab22-dbpedia-all0): tr_loss=0.3347475 tr_macro_f1=0.8259 tr_micro_f1=0.9470  vl_loss=2.3558319 vl_macro_f1=0.2578 vl_micro_f1=0.5216 (52.96 sec.)
Epoch 10 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 10 (gt-semtab22-dbpedia-all0): tr_loss=0.2704703 tr_macro_f1=0.8715 tr_micro_f1=0.9617  vl_loss=2.4472373 vl_macro_f1=0.2711 vl_micro_f1=0.5237 (53.05 sec.)
Epoch 11 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 11 (gt-semtab22-dbpedia-all0): tr_loss=0.2136146 tr_macro_f1=0.9233 tr_micro_f1=0.9747  vl_loss=2.3579845 vl_macro_f1=0.2935 vl_micro_f1=0.5342 (52.76 sec.)
Epoch 12 starts
Epoch 12 (gt-semtab22-dbpedia-all0): tr_loss=0.1360898 tr_macro_f1=0.9744 tr_micro_f1=0.9897  vl_loss=2.4042914 vl_macro_f1=0.2819 vl_micro_f1=0.5352 (52.22 sec.)
Epoch 13 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 13 (gt-semtab22-dbpedia-all0): tr_loss=0.1061496 tr_macro_f1=0.9761 tr_micro_f1=0.9918  vl_loss=2.4831959 vl_macro_f1=0.3005 vl_micro_f1=0.5405 (52.24 sec.)
Epoch 14 starts
Epoch 14 (gt-semtab22-dbpedia-all0): tr_loss=0.0860638 tr_macro_f1=0.9813 tr_micro_f1=0.9940  vl_loss=2.4984935 vl_macro_f1=0.2895 vl_micro_f1=0.5331 (52.15 sec.)
Epoch 15 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 15 (gt-semtab22-dbpedia-all0): tr_loss=0.0617358 tr_macro_f1=0.9947 tr_micro_f1=0.9976  vl_loss=2.5047420 vl_macro_f1=0.2803 vl_micro_f1=0.5247 (52.45 sec.)
Epoch 16 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 16 (gt-semtab22-dbpedia-all0): tr_loss=0.0445301 tr_macro_f1=0.9996 tr_micro_f1=0.9997  vl_loss=2.5625763 vl_macro_f1=0.2909 vl_micro_f1=0.5373 (52.48 sec.)
Epoch 17 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 17 (gt-semtab22-dbpedia-all0): tr_loss=0.0411657 tr_macro_f1=0.9985 tr_micro_f1=0.9986  vl_loss=2.6594541 vl_macro_f1=0.2748 vl_micro_f1=0.5258 (52.49 sec.)
Epoch 18 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 18 (gt-semtab22-dbpedia-all0): tr_loss=0.0341289 tr_macro_f1=0.9995 tr_micro_f1=0.9995  vl_loss=2.5918108 vl_macro_f1=0.2829 vl_micro_f1=0.5373 (52.55 sec.)
Epoch 19 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 19 (gt-semtab22-dbpedia-all0): tr_loss=0.0274599 tr_macro_f1=0.9994 tr_micro_f1=0.9995  vl_loss=2.6233035 vl_macro_f1=0.2794 vl_micro_f1=0.5321 (52.36 sec.)
Epoch 20 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 20 (gt-semtab22-dbpedia-all0): tr_loss=0.0284502 tr_macro_f1=0.9987 tr_micro_f1=0.9992  vl_loss=2.6558643 vl_macro_f1=0.2861 vl_micro_f1=0.5331 (52.24 sec.)
Epoch 21 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 21 (gt-semtab22-dbpedia-all0): tr_loss=0.0215954 tr_macro_f1=0.9991 tr_micro_f1=0.9995  vl_loss=2.6845417 vl_macro_f1=0.2849 vl_micro_f1=0.5352 (52.31 sec.)
Epoch 22 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 22 (gt-semtab22-dbpedia-all0): tr_loss=0.0229379 tr_macro_f1=0.9995 tr_micro_f1=0.9995  vl_loss=2.6975255 vl_macro_f1=0.2795 vl_micro_f1=0.5310 (52.31 sec.)
Epoch 23 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 23 (gt-semtab22-dbpedia-all0): tr_loss=0.0210290 tr_macro_f1=0.9984 tr_micro_f1=0.9986  vl_loss=2.7255319 vl_macro_f1=0.2850 vl_micro_f1=0.5310 (52.29 sec.)
Epoch 24 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 24 (gt-semtab22-dbpedia-all0): tr_loss=0.0187136 tr_macro_f1=0.9995 tr_micro_f1=0.9995  vl_loss=2.7360528 vl_macro_f1=0.2868 vl_micro_f1=0.5310 (52.31 sec.)
Epoch 25 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 25 (gt-semtab22-dbpedia-all0): tr_loss=0.0179022 tr_macro_f1=0.9995 tr_micro_f1=0.9995  vl_loss=2.7336821 vl_macro_f1=0.2825 vl_micro_f1=0.5247 (52.40 sec.)
Epoch 26 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 26 (gt-semtab22-dbpedia-all0): tr_loss=0.0151726 tr_macro_f1=0.9996 tr_micro_f1=0.9997  vl_loss=2.7354154 vl_macro_f1=0.2862 vl_micro_f1=0.5289 (52.29 sec.)
Epoch 27 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 27 (gt-semtab22-dbpedia-all0): tr_loss=0.0167781 tr_macro_f1=0.9988 tr_micro_f1=0.9992  vl_loss=2.7396200 vl_macro_f1=0.2871 vl_micro_f1=0.5321 (53.04 sec.)
Epoch 28 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 28 (gt-semtab22-dbpedia-all0): tr_loss=0.0143437 tr_macro_f1=0.9996 tr_micro_f1=0.9997  vl_loss=2.7421868 vl_macro_f1=0.2858 vl_micro_f1=0.5268 (53.03 sec.)
Epoch 29 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 29 (gt-semtab22-dbpedia-all0): tr_loss=0.0191337 tr_macro_f1=0.9993 tr_micro_f1=0.9989  vl_loss=2.7551407 vl_macro_f1=0.2880 vl_micro_f1=0.5268 (53.00 sec.)
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Traceback (most recent call last):
  File "supcl_ft.py", line 880, in <module>
    logits = model(batch["data"].T)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/TU/watchog/watchog/model.py", line 490, in forward
    bert_output = self.bert(input_ids)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 1013, in forward
    encoder_outputs = self.encoder(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 607, in forward
    layer_outputs = layer_module(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 539, in forward
    layer_output = apply_chunking_to_forward(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/pytorch_utils.py", line 242, in apply_chunking_to_forward
    return forward_fn(*input_tensors)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 551, in feed_forward_chunk
    intermediate_output = self.intermediate(attention_output)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 452, in forward
    hidden_states = self.intermediate_act_fn(hidden_states)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/activations.py", line 78, in forward
    return self.act(input)
RuntimeError: CUDA out of memory. Tried to allocate 96.00 MiB (GPU 0; 23.48 GiB total capacity; 19.87 GiB already allocated; 49.56 MiB free; 21.11 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF