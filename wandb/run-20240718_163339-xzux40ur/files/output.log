/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/optimization.py:429: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
supcl_ft.py:642: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matricesor `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2981.)
  labels = batch["label"].T
Epoch 0 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 0 (gt-semtab22-dbpedia-all0): tr_loss=3.6132470 tr_macro_f1=0.0051 tr_micro_f1=0.2147  vl_loss=3.4327915 vl_macro_f1=0.0069 vl_micro_f1=0.2355 (52.65 sec.)
Epoch 1 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 1 (gt-semtab22-dbpedia-all0): tr_loss=3.3625651 tr_macro_f1=0.0165 tr_micro_f1=0.2378  vl_loss=3.2890424 vl_macro_f1=0.0164 vl_micro_f1=0.2397 (53.45 sec.)
Epoch 2 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 2 (gt-semtab22-dbpedia-all0): tr_loss=3.1276205 tr_macro_f1=0.0281 tr_micro_f1=0.2598  vl_loss=3.1298760 vl_macro_f1=0.0296 vl_micro_f1=0.2608 (53.81 sec.)
Epoch 3 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 3 (gt-semtab22-dbpedia-all0): tr_loss=2.7761251 tr_macro_f1=0.0563 tr_micro_f1=0.3465  vl_loss=2.7805157 vl_macro_f1=0.0560 vl_micro_f1=0.3502 (52.56 sec.)
Epoch 4 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 4 (gt-semtab22-dbpedia-all0): tr_loss=2.2979087 tr_macro_f1=0.0880 tr_micro_f1=0.4557  vl_loss=2.5867629 vl_macro_f1=0.0727 vl_micro_f1=0.4217 (52.59 sec.)
Epoch 5 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 5 (gt-semtab22-dbpedia-all0): tr_loss=1.9404689 tr_macro_f1=0.1335 tr_micro_f1=0.5451  vl_loss=2.4508754 vl_macro_f1=0.1090 vl_micro_f1=0.4353 (52.60 sec.)
Epoch 6 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 6 (gt-semtab22-dbpedia-all0): tr_loss=1.5857066 tr_macro_f1=0.1880 tr_micro_f1=0.6122  vl_loss=2.4170570 vl_macro_f1=0.1442 vl_micro_f1=0.4543 (52.59 sec.)
Epoch 7 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 7 (gt-semtab22-dbpedia-all0): tr_loss=1.3021730 tr_macro_f1=0.2841 tr_micro_f1=0.6897  vl_loss=2.4198139 vl_macro_f1=0.1807 vl_micro_f1=0.4784 (52.72 sec.)
Epoch 8 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 8 (gt-semtab22-dbpedia-all0): tr_loss=1.0131228 tr_macro_f1=0.3910 tr_micro_f1=0.7606  vl_loss=2.4069055 vl_macro_f1=0.1997 vl_micro_f1=0.4732 (54.47 sec.)
Epoch 9 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 9 (gt-semtab22-dbpedia-all0): tr_loss=0.8261811 tr_macro_f1=0.4793 tr_micro_f1=0.8084  vl_loss=2.4257880 vl_macro_f1=0.1987 vl_micro_f1=0.4921 (54.21 sec.)
Epoch 10 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 10 (gt-semtab22-dbpedia-all0): tr_loss=0.6504569 tr_macro_f1=0.5839 tr_micro_f1=0.8562  vl_loss=2.4755951 vl_macro_f1=0.2373 vl_micro_f1=0.4763 (54.42 sec.)
Epoch 11 starts
Epoch 11 (gt-semtab22-dbpedia-all0): tr_loss=0.5462195 tr_macro_f1=0.6727 tr_micro_f1=0.8861  vl_loss=2.5672567 vl_macro_f1=0.2370 vl_micro_f1=0.4921 (54.49 sec.)
Epoch 12 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 12 (gt-semtab22-dbpedia-all0): tr_loss=0.4707975 tr_macro_f1=0.7111 tr_micro_f1=0.9022  vl_loss=2.4543870 vl_macro_f1=0.2471 vl_micro_f1=0.4963 (53.18 sec.)
Epoch 13 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 13 (gt-semtab22-dbpedia-all0): tr_loss=0.3426728 tr_macro_f1=0.7908 tr_micro_f1=0.9353  vl_loss=2.5069141 vl_macro_f1=0.2515 vl_micro_f1=0.4963 (52.94 sec.)
Epoch 14 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 14 (gt-semtab22-dbpedia-all0): tr_loss=0.2705222 tr_macro_f1=0.8571 tr_micro_f1=0.9552  vl_loss=2.5639674 vl_macro_f1=0.2539 vl_micro_f1=0.4932 (53.09 sec.)
Epoch 15 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 15 (gt-semtab22-dbpedia-all0): tr_loss=0.2078239 tr_macro_f1=0.9003 tr_micro_f1=0.9685  vl_loss=2.5221108 vl_macro_f1=0.2613 vl_micro_f1=0.5026 (53.11 sec.)
Epoch 16 starts
Epoch 16 (gt-semtab22-dbpedia-all0): tr_loss=0.1696865 tr_macro_f1=0.9225 tr_micro_f1=0.9764  vl_loss=2.5625088 vl_macro_f1=0.2592 vl_micro_f1=0.4974 (52.99 sec.)
Epoch 17 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 17 (gt-semtab22-dbpedia-all0): tr_loss=0.1399597 tr_macro_f1=0.9464 tr_micro_f1=0.9799  vl_loss=2.6027005 vl_macro_f1=0.2605 vl_micro_f1=0.5005 (53.29 sec.)
Epoch 18 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 18 (gt-semtab22-dbpedia-all0): tr_loss=0.1263866 tr_macro_f1=0.9471 tr_micro_f1=0.9812  vl_loss=2.5937256 vl_macro_f1=0.2749 vl_micro_f1=0.5174 (53.47 sec.)
Epoch 19 starts
Epoch 19 (gt-semtab22-dbpedia-all0): tr_loss=0.1109019 tr_macro_f1=0.9568 tr_micro_f1=0.9832  vl_loss=2.6368450 vl_macro_f1=0.2634 vl_micro_f1=0.5005 (53.00 sec.)
Epoch 20 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 20 (gt-semtab22-dbpedia-all0): tr_loss=0.0933540 tr_macro_f1=0.9660 tr_micro_f1=0.9864  vl_loss=2.6415271 vl_macro_f1=0.2638 vl_micro_f1=0.4942 (53.19 sec.)
Epoch 21 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 21 (gt-semtab22-dbpedia-all0): tr_loss=0.0777657 tr_macro_f1=0.9706 tr_micro_f1=0.9883  vl_loss=2.6422040 vl_macro_f1=0.2589 vl_micro_f1=0.5037 (53.69 sec.)
Epoch 22 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 22 (gt-semtab22-dbpedia-all0): tr_loss=0.0655800 tr_macro_f1=0.9758 tr_micro_f1=0.9908  vl_loss=2.6674556 vl_macro_f1=0.2742 vl_micro_f1=0.5058 (53.26 sec.)
Epoch 23 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 23 (gt-semtab22-dbpedia-all0): tr_loss=0.0577625 tr_macro_f1=0.9766 tr_micro_f1=0.9927  vl_loss=2.6991799 vl_macro_f1=0.2585 vl_micro_f1=0.5005 (53.55 sec.)
Epoch 24 starts
Epoch 24 (gt-semtab22-dbpedia-all0): tr_loss=0.0588275 tr_macro_f1=0.9794 tr_micro_f1=0.9918  vl_loss=2.6866449 vl_macro_f1=0.2621 vl_micro_f1=0.5016 (53.47 sec.)
Epoch 25 starts
Epoch 25 (gt-semtab22-dbpedia-all0): tr_loss=0.0493565 tr_macro_f1=0.9822 tr_micro_f1=0.9938  vl_loss=2.7070184 vl_macro_f1=0.2657 vl_micro_f1=0.5058 (53.61 sec.)
Epoch 26 starts
Epoch 26 (gt-semtab22-dbpedia-all0): tr_loss=0.0463053 tr_macro_f1=0.9849 tr_micro_f1=0.9948  vl_loss=2.7178635 vl_macro_f1=0.2558 vl_micro_f1=0.5016 (58.37 sec.)
Epoch 27 starts
Epoch 27 (gt-semtab22-dbpedia-all0): tr_loss=0.0414103 tr_macro_f1=0.9852 tr_micro_f1=0.9948  vl_loss=2.7265548 vl_macro_f1=0.2627 vl_micro_f1=0.5047 (56.47 sec.)
Epoch 28 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 28 (gt-semtab22-dbpedia-all0): tr_loss=0.0401561 tr_macro_f1=0.9898 tr_micro_f1=0.9965  vl_loss=2.7263139 vl_macro_f1=0.2657 vl_micro_f1=0.5068 (53.09 sec.)
Epoch 29 starts
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Epoch 29 (gt-semtab22-dbpedia-all0): tr_loss=0.0397657 tr_macro_f1=0.9902 tr_micro_f1=0.9965  vl_loss=2.7260831 vl_macro_f1=0.2642 vl_micro_f1=0.5058 (53.12 sec.)
/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Traceback (most recent call last):
  File "supcl_ft.py", line 880, in <module>
    logits = model(batch["data"].T)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/TU/watchog/watchog/model.py", line 490, in forward
    bert_output = self.bert(input_ids)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 1013, in forward
    encoder_outputs = self.encoder(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 607, in forward
    layer_outputs = layer_module(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 497, in forward
    self_attention_outputs = self.attention(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 427, in forward
    self_outputs = self.self(
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zhihao/jupyterprojects/jupyter/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 325, in forward
    attention_scores = torch.matmul(query_layer, key_layer.transpose(-1, -2))
RuntimeError: CUDA out of memory. Tried to allocate 190.00 MiB (GPU 0; 23.48 GiB total capacity; 21.24 GiB already allocated; 98.88 MiB free; 22.35 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF